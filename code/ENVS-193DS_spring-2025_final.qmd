---
title: "ENVS 193DS Spring 2025 Final"
author: Ellie Schomberg
date: 06-11-2025
format: 
  html:
    toc: true
---

Link to the GitHub repository is [here](https://github.com/ellieschomberg/ENVS-193DS_spring-2025_final)

# Set Up

```{r set up}
#| message: FALSE
# reading in packages
library(tidyverse)
library(janitor)
library(here)
library(flextable)
library(readxl)
library(DHARMa)
library(MuMIn)

# reading in data
sst <- read.csv(here("data", "SST_update2023.csv"))
```

# Problem 1. Research Writing

## a. Transparent statistical methods

In part 1, they used a Pearson's r test. In part 2, they used an ANOVA.

## b. More information needed

One additional piece of information that should be included in the results section is a post hoc test, like the Tukey's HSD. We know from the results of the ANOVA that at least two of the groups are different from each other, but not which ones. The Tukey's HSD would provide information as to which groups are significantly different from each other. In this example, a Tukey's HSD would be able to tell you which two sources between urban land, atmospheric deposition, fertilizer, wastewater treatment, and grassland were significantly different from each other in terms of average nitrogen load. Another additional piece of information that could be included in the results is the effect size, which quantifies how much the grouping variable affects the response variable. In this example, the effect size would tell whether the different sources had a negligible, small, medium, or large effect on the nitrogen load.

## c. Suggestions for rewriting

Part 1:

There is a [weak, moderate, strong] [positive, negative] relationship between the distance from headwater (km) and the annual total nitrogen load (kg/year) (Pearson's r = correlation coefficient, p = 0.03, $\alpha$ = significance level).

Part 2:

We found a [small, medium, large] difference ($\eta^2$ = effect size) between sources in average average nitrogen load (one way ANOVA, F(num df, denom df) = F-statistic, p = 0.02, $\alpha$ = significant level). On average (one of the significantly different sources) tended to have a [higher or lower] average nitrogen load than (other significantly different source) (ex results from Tukey's HSD (difference) kg/year, 95% CI: [value, value] kg/year).


# Problem 2. Data visualization

## a. Cleaning and summarizing

```{r cleaning and summarizing}
#| message: FALSE
sst_clean <- sst |>  # starting with sst data frame
  mutate(
    month = month(date, label = TRUE, abbr = TRUE) |>  # adding a column for months
              factor(levels = month.abb, ordered = TRUE), # creating the months as an ordinal factor with name abbreviations
    year = year(date)) |> # creating a column for years
  group_by(month, year) |>  # grouping the data by month and year
  summarize(mean_monthly_sst = mean(temp, na.rm = TRUE))  |> # creating the mean monthly sst column
  ungroup() |> 
  filter(year %in% c("2018", "2019", "2020", "2021", "2022", "2023")) |> # filtering to include 2018-2023
  mutate( year = as_factor(year), # making the years a factor
          year = fct_relevel(year,"2018", "2019", "2020", "2021", "2022", "2023")) |> 
  select( year, month, mean_monthly_sst) # selecting the columns of interest

slice_sample(sst_clean, n=5) 
str(sst_clean)
```


## b. Visualize the data

```{r visualization}
#| warning: FALSE
ggplot(data = sst_clean, # starting with sst_clean data frame
       aes(x= month, # x axis is month
           y = mean_monthly_sst, # y axis is mean monthly sst
           color = year, # color and group data by year
           group = year)) +
  geom_point() + # adding points
  geom_line() + # addding lines
  scale_color_manual(values = c("2023" = "steelblue4", # creating color gradient
                                "2022" = "steelblue", 
                                "2021" = "steelblue3", 
                                "2020" = "steelblue2",  
                                "2019" = "steelblue1", 
                                "2018" = "lightskyblue")) +
  labs(x = "Month", # renaming x axis
       y = "Mean monthly sea surface temperature (Â°C)", # renaming y axis
       color = "Year") + # renaming legend
  theme(panel.background = element_blank(), # making background blank
        panel.border = element_rect(color = "gray", fill = NA, linewidth = 1), # adding border
        axis.line = element_blank(), # getting rid of gridlines
        legend.position = c(0.05, 0.95), # moving legend to the top left inside the panel
        legend.justification = c(0, 1))
```


# Problem 3. Data analysis

## a. Response variable

## b. Purpose of study

## c. Difference in "seasons"

## d. Table of models

## e. Run the models

## f. Check the diagnostics

## g. Select the best model

## h. Visualize the model predictions

## i. Write a caption for your figure

## j.. Calculate model predictions

## k. Interpret your results

# Problem 4. Affective and explanatory visualizations

## a. Comparing visualizations



## b. Sharing your affective visualization

